# 投資損益分析報告生成器(資料皆為虛構資料)
<div style="text-align:center;">
  <div style="margin-bottom:10px;">
    <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExaWlpa2s5am1kNzIwZzhzcGx2OG9sNnV6aGEzeDJ6M3Zsc3Vnb3RheSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/jAoMf14h0ZQQw/giphy.gif" alt="Giphy" width="450" style="display:block; margin: 0 auto;" />
  </div>
  <div>
    <img src="docs/image/1745274567786.gif" alt="GIF 1" width="150" style="display:inline-block; margin-right:5px;" />
    <img src="docs/image/btc-bitcoin.gif" alt="BTC" width="150" style="display:inline-block; margin-right:5px;" />
    <img src="docs/image/up-higher.gif" alt="上漲" width="150" style="display:inline-block;" />
  </div>
</div>



## 在線預覽
- 報告範例：[投資損益分析報告](https://fgh09101010.github.io/StockProfitAnalyzer/%E6%8A%95%E8%B3%87%E6%90%8D%E7%9B%8A%E5%88%86%E6%9E%90%E5%A0%B1%E5%91%8A.html)

## 投資損益報告 (Markdown 格式)

完整報告請參考 [investment_report.md](docs/investment_report.md)。

## 專案概述
本專案是一個 Python 程式，用於讀取 Excel 檔案中的投資數據，生成視覺化的投資損益分析報告。報告以 HTML 格式呈現，包含互動式圖表、數據表格及投資金額分配模擬功能，幫助使用者快速了解投資組合表現。

## 功能
- **數據處理**：從 Excel 檔案 (`未實現損益試算.xlsx`) 讀取並清理投資數據。
- **視覺化圖表**：
  - 柱狀圖：比較各商品的投資成本與市值。
  - 氣泡圖：展示投資成本、損益率與股數關係。
  - 圓餅圖：顯示不同損益區間的投資成本比例。
- **數據表格**：使用 DataTables 提供可排序、搜尋的投資明細。
- **投資分配模擬**：根據正報酬項目，動態計算指定金額的分配比例。
- **報告生成**：輸出包含圖表與表格的 HTML 報告，支援中文與響應式設計。

## 執行方式
1. **環境準備**：
   - 安裝 Python 3.6+。
   - 安裝依賴套件：
    ```
     pip install pandas openpyxl
    ```
2. **準備數據**：
   - 將 `未實現損益試算.xlsx` 置於專案根目錄，需包含欄位：項次、商品名稱、類別、股數、成本價、投資成本、帳面收入、損益、損益率、現價、市值、幣別。
3. **執行程式**：
    ```
     python analyze_stock.py
    ```
   程式將生成 `docs/投資損益分析報告.html`。
4. **查看報告**：
   - 於瀏覽器開啟 HTML 檔案，或部署 `docs` 資料夾至 GitHub Pages。

## 依賴套件
- **Python 套件**：
  - `pandas`：數據處理與 Excel 讀取。
  - `openpyxl`：Excel 檔案支援。
- **前端套件**（內嵌於 HTML）：
  - Chart.js：生成互動式圖表。
  - jQuery：支援 DataTables。
  - DataTables：提供動態表格功能。


## 注意事項
- 確保 Excel 檔案格式正確，否則可能導致數據處理錯誤。
- 報告中的圖表與表格需連網載入 CDN 資源。
- 可修改 HTML 中的 CSS 自訂樣式。

## 授權
本專案僅供學習與個人使用，請勿用於商業用途。


# 其他資訊

## 年化報酬率累積表（轉置：年數為列，報酬率為欄）

單位：累積報酬率（四捨五入至小數點後四位，含複利）

| 年數 | 1% | 2% | 3% | 4% | 5% | 6% | 7% | 8% | 9% | 10% |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 1年 | 0.0100 | 0.0200 | 0.0300 | 0.0400 | 0.0500 | 0.0600 | 0.0700 | 0.0800 | 0.0900 | 0.1000 |
| 2年 | 0.0201 | 0.0404 | 0.0609 | 0.0816 | 0.1025 | 0.1236 | 0.1449 | 0.1664 | 0.1881 | 0.2100 |
| 3年 | 0.0303 | 0.0612 | 0.0927 | 0.1249 | 0.1576 | 0.1910 | 0.2250 | 0.2597 | 0.2950 | 0.3310 |
| 4年 | 0.0406 | 0.0824 | 0.1255 | 0.1699 | 0.2155 | 0.2625 | 0.3108 | 0.3605 | 0.4116 | 0.4641 |
| 5年 | 0.0510 | 0.1041 | 0.1593 | 0.2167 | 0.2763 | 0.3382 | 0.4026 | 0.4693 | 0.5386 | 0.6105 |
| 6年 | 0.0615 | 0.1262 | 0.1941 | 0.2653 | 0.3401 | 0.4185 | 0.5007 | 0.5869 | 0.6771 | 0.7716 |
| 7年 | 0.0721 | 0.1487 | 0.2299 | 0.3159 | 0.4071 | 0.5036 | 0.6058 | 0.7138 | 0.8280 | 0.9487 |
| 8年 | 0.0829 | 0.1717 | 0.2668 | 0.3686 | 0.4775 | 0.5938 | 0.7182 | 0.8509 | 0.9926 | 1.1436 |
| 9年 | 0.0937 | 0.1951 | 0.3048 | 0.4233 | 0.5513 | 0.6895 | 0.8385 | 0.9990 | 1.1719 | 1.3579 |
| 10年 | 0.1046 | 0.2190 | 0.3439 | 0.4802 | 0.6289 | 0.7908 | 0.9672 | 1.1589 | 1.3674 | 1.5937 |
| 11年 | 0.1157 | 0.2434 | 0.3842 | 0.5395 | 0.7103 | 0.8983 | 1.1049 | 1.3316 | 1.5804 | 1.8531 |
| 12年 | 0.1268 | 0.2682 | 0.4258 | 0.6010 | 0.7959 | 1.0122 | 1.2522 | 1.5182 | 1.8127 | 2.1384 |
| 13年 | 0.1381 | 0.2936 | 0.4685 | 0.6651 | 0.8856 | 1.1329 | 1.4098 | 1.7196 | 2.0658 | 2.4523 |
| 14年 | 0.1495 | 0.3195 | 0.5126 | 0.7317 | 0.9799 | 1.2609 | 1.5785 | 1.9372 | 2.3417 | 2.7975 |
| 15年 | 0.1610 | 0.3459 | 0.5580 | 0.8009 | 1.0789 | 1.3966 | 1.7590 | 2.1722 | 2.6425 | 3.1772 |
| 16年 | 0.1726 | 0.3728 | 0.6047 | 0.8730 | 1.1829 | 1.5404 | 1.9522 | 2.4259 | 2.9703 | 3.5950 |
| 17年 | 0.1843 | 0.4002 | 0.6528 | 0.9479 | 1.2920 | 1.6928 | 2.1588 | 2.7000 | 3.3276 | 4.0545 |
| 18年 | 0.1961 | 0.4282 | 0.7024 | 1.0258 | 1.4066 | 1.8543 | 2.3799 | 2.9960 | 3.7171 | 4.5599 |
| 19年 | 0.2081 | 0.4568 | 0.7535 | 1.1068 | 1.5270 | 2.0256 | 2.6165 | 3.3157 | 4.1417 | 5.1159 |
| 20年 | 0.2202 | 0.4859 | 0.8061 | 1.1911 | 1.6533 | 2.2071 | 2.8697 | 3.6610 | 4.6044 | 5.7275 |
| 21年 | 0.2324 | 0.5157 | 0.8603 | 1.2788 | 1.7860 | 2.3996 | 3.1406 | 4.0338 | 5.1088 | 6.4002 |
| 22年 | 0.2447 | 0.5460 | 0.9161 | 1.3699 | 1.9253 | 2.6035 | 3.4304 | 4.4365 | 5.6586 | 7.1403 |
| 23年 | 0.2572 | 0.5769 | 0.9736 | 1.4647 | 2.0715 | 2.8197 | 3.7405 | 4.8715 | 6.2579 | 7.9543 |
| 24年 | 0.2697 | 0.6084 | 1.0328 | 1.5633 | 2.2251 | 3.0489 | 4.0724 | 5.3412 | 6.9111 | 8.8497 |
| 25年 | 0.2824 | 0.6406 | 1.0938 | 1.6658 | 2.3864 | 3.2919 | 4.4274 | 5.8485 | 7.6231 | 9.8347 |
| 26年 | 0.2953 | 0.6734 | 1.1566 | 1.7725 | 2.5557 | 3.5494 | 4.8074 | 6.3964 | 8.3992 | 10.9182 |
| 27年 | 0.3082 | 0.7069 | 1.2213 | 1.8834 | 2.7335 | 3.8223 | 5.2139 | 6.9881 | 9.2451 | 12.1100 |
| 28年 | 0.3213 | 0.7410 | 1.2879 | 1.9987 | 2.9201 | 4.1117 | 5.6488 | 7.6271 | 10.1671 | 13.4210 |
| 29年 | 0.3345 | 0.7758 | 1.3566 | 2.1187 | 3.1161 | 4.4184 | 6.1143 | 8.3173 | 11.1722 | 14.8631 |
| 30年 | 0.3478 | 0.8114 | 1.4273 | 2.2434 | 3.3219 | 4.7435 | 6.6123 | 9.0627 | 12.2677 | 16.4494 |
| 31年 | 0.3613 | 0.8476 | 1.5001 | 2.3731 | 3.5380 | 5.0881 | 7.1451 | 9.8677 | 13.4618 | 18.1943 |
| 32年 | 0.3749 | 0.8845 | 1.5751 | 2.5081 | 3.7649 | 5.4534 | 7.7153 | 10.7371 | 14.7633 | 20.1138 |
| 33年 | 0.3887 | 0.9222 | 1.6523 | 2.6484 | 4.0032 | 5.8406 | 8.3253 | 11.6760 | 16.1820 | 22.2252 |
| 34年 | 0.4026 | 0.9607 | 1.7319 | 2.7943 | 4.2533 | 6.2510 | 8.9781 | 12.6901 | 17.7284 | 24.5477 |
| 35年 | 0.4166 | 0.9999 | 1.8139 | 2.9461 | 4.5160 | 6.6861 | 9.6766 | 13.7853 | 19.4140 | 27.1024 |
| 36年 | 0.4308 | 1.0399 | 1.8983 | 3.1039 | 4.7918 | 7.1473 | 10.4239 | 14.9682 | 21.2512 | 29.9127 |
| 37年 | 0.4451 | 1.0807 | 1.9852 | 3.2681 | 5.0814 | 7.6361 | 11.2236 | 16.2456 | 23.2538 | 33.0039 |
| 38年 | 0.4595 | 1.1223 | 2.0748 | 3.4388 | 5.3855 | 8.1543 | 12.0793 | 17.6253 | 25.4367 | 36.4043 |
| 39年 | 0.4741 | 1.1647 | 2.1670 | 3.6164 | 5.7048 | 8.7035 | 12.9948 | 19.1153 | 27.8160 | 40.1448 |
| 40年 | 0.4889 | 1.2080 | 2.2620 | 3.8010 | 6.0400 | 9.2857 | 13.9745 | 20.7245 | 30.4094 | 44.2593 |


---
### 📌 備註說明：

- 本表為**年化報酬率含複利計算**之累積報酬率對照表，方便快速查詢長期投資效果。
- 計算公式如下：

  ```
  累積報酬率 = (1 + 年化報酬率) ^ 年數 - 1
  ```

  例如，年化報酬率為 5%、投資 10 年：

  ```
  (1 + 0.05) ^ 10 - 1 ≈ 0.6289（約等於 62.89%）
  ```

- `-1` 是**正確的減法邏輯**，因為 `(1 + r)^n` 是總資產倍數，要轉換成報酬率需減去本金（即 1）。
- 如果你需要在計算最終資產價值，就利用上方的表加回本金（即 1）。
- 所有數值均已**四捨五入至小數點後四位**，可用於簡易財務試算或投資估算。


## 真實年化報酬率 (CAGR) 換算表

單位：年化報酬率 (百分比，四捨五入至小數點後兩位)

### 資料範圍

| 資產 | 資料起始日 | 資料結束日 |
| --- | --- | --- |
| 2330 | 2000-01-04 | 2025-08-07 |
| 2539 | 2000-01-04 | 2025-08-07 |
| 0050 | 2009-01-02 | 2025-08-07 |
| 加權指數 | 1997-07-02 | 2025-08-07 |
| S&P500 | 1989-08-08 | 2025-08-06 |
| NASDAQ | 1989-08-08 | 2025-08-06 |

---
| 期間 | 2330 | 2539 | 0050 | 加權指數 | S&P500 | NASDAQ |
| --- | --- | --- | --- | --- | --- | --- |
| 5年 | 24.43% | 33.56% | 16.33% | 13.23% | 13.56% | 14.05% |
| 10年 | 28.17% | 24.20% | 14.62% | 10.98% | 11.67% | 15.29% |
| 15年 | 25.40% | 24.08% | 1.70% | 7.57% | 12.21% | 15.93% |
| 20年 | 21.22% | 16.83% | N/A | 6.85% | 8.58% | 12.08% |
| 25年 | 15.75% | 1.53% | N/A | 4.60% | 5.99% | 7.06% |
| 30年 | N/A | N/A | N/A | N/A | 8.43% | 10.72% |
| 35年 | N/A | N/A | N/A | N/A | 8.74% | 11.95% |
---
### 說明
- 表中年化報酬率 (CAGR) 根據指定期間的收盤價計算。
- CAGR 計算公式：

  ```
  CAGR = (終值 / 初值)^(1/年數) - 1
  ```


- 資料來源：Yahoo Finance。
